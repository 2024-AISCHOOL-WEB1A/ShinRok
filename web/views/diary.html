<!DOCTYPE html>
<html lang='en'>
<head>
    <title>ğŸ“•ë‹¤ì´ì–´ë¦¬ğŸ“•</title>
    <meta charset='utf-8' />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="../public/diary.css">
    <link rel="stylesheet" href="../public/main.css">
</head>
<body>
<form action="/diary/submit" method="post" enctype="multipart/form-data" class="diaryForm" id="diaryForm">




    <!-- Header -->
    <header id="header">
        <!-- <a href="/" class="logo"><img src="https://jsh-1.s3.ap-northeast-2.amazonaws.com/test/KakaoTalk_20240722_163631321_07.png" alt="ë¬´ëŸ­ì´">
            <strong>MURUK </strong> <span>by ShinRok</span></a> -->
        <ul class="icons">
            {% if user %}
            <li><a href="#">{{user.nick}}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.</a></li>
            {% else %}
            <li><a href="#">ë¡œê·¸ì¸ í›„ ì´ìš©í•´ì£¼ì„¸ìš”.</a></li>
            {% endif %}
            <li>
                <form id="myPageForm" action="/myPage/info" method="post">
                    <a href="#" onclick="document.getElementById('myPageForm').submit(); return false;">ë§ˆì´í˜ì´ì§€</a>
                </form>
                <!-- <li><a href="/myPage/info" id="myPageLink">ë§ˆì´í˜ì´ì§€</a></li> --> 
            </li>
            {% if user %}
            <div class="kakaoLogout">
                <a href="/user/logout">ë¡œê·¸ì•„ì›ƒ<img src=""></a>
            </div>
            {% else %}
            <div class="kakaoLogin">
                <a href="/user/login"><img src="https://jsh-1.s3.ap-northeast-2.amazonaws.com/test/kakao_login_small+(1).png"></a>
            </div>
            {% endif %}
        </ul>
    </header>





    <div id="container">
        {% if user %}
        <input type="hidden" name="idx" value="{{ user.idx }}">
        {% endif %}
        <aside class="leftSidebar">
            <nav class="topsidebar">
                <ul>
                    <li><a href="/">HOME</a></li>
                    <li><a href="/board/freeList">ììœ ê²Œì‹œíŒ</a></li>
                    <li><a href="/board/bragPost">ìë‘í•˜ê¸°</a></li>
                    <li><a href="/board/hotPost">ì¸ê¸°ê¸€</a></li>
                    <li><a href="/board/queslist">ì§ˆë¬¸ê²Œì‹œíŒ</a></li>
                </ul>
            </nav>
            <!-- ì•„ë˜ìª½ ì‚¬ì´ë“œë°”(í˜ì´ì§€ ì´ë™) -->
            <nav class="underSidebar">
                <ul>
                    <li id="pointLi"><a href="/diary">Diary</a></li>
                    <li><a href="/predict">ë³‘ì¶©í•´ ì§„ë‹¨</a></li>
                    <li><a href="/dictionary/home">ì‹ë¬¼ ë„ê°</a></li>
                    <li><a href="/myPage/info">ë§ˆì´í˜ì´ì§€</a></li>
                </ul>
            </nav>
        </aside>

        <section class="calendarForm">
            <div id='calendar'></div>

            <!-- ë¹ˆ ë‚ ì§œ ëª¨ë‹¬ -->
            <div id="myModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <p id="modal-text"></p>
                    <input type="hidden" name="modalText" id="modalText">
                    <p><input type="text" placeholder="ì œëª©" name="title" id="title" size="100%"></p>
                    <textarea name="content" id="content" placeholder="ë‚´ìš©" style="resize: none;"></textarea>
                    <div id="modal_bottom">
                        <div id="stk">
                            <div class="weather">ë‚ ì”¨<br>
                                <div class="radio-container">
                                    <input type="radio" id="sun" name="weather" value="sun" class="radio-button">
                                    <label for="sun"><img src="https://url.kr/ovusa3" alt="í•´" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="rain" name="weather" value="rain" class="radio-button">
                                    <label for="rain"><img src="https://url.kr/qjvl4s" alt="ë¹„" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="thunder" name="weather" value="thunder" class="radio-button">
                                    <label for="thunder"><img src="https://url.kr/qelhx4" alt="ë²ˆê°œ" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="cloud" name="weather" value="cloud" class="radio-button">
                                    <label for="cloud"><img src="https://url.kr/5wsmzp" alt="êµ¬ë¦„" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="snow" name="weather" value="snow" class="radio-button">
                                    <label for="snow"><img src="https://url.kr/jjyn7y" alt="ëˆˆ" class="sticker"></label>
                                </div>
                            </div>
                            <div id="do" class="custom-radio">í–‰ë™ <br>
                                <div class="radio-container">
                                    <input type="radio" id="water" name="do" value="water" class="radio-button">
                                    <label for="water"><img src="https://url.kr/x5zahb" alt="ë¬¼ì£¼ê¸°" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="seed" name="do" value="seed" class="radio-button">
                                    <label for="seed"><img src="https://url.kr/ndtb2h" alt="ì‹¬ê¸°" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="cut" name="do" value="cut" class="radio-button">
                                    <label for="cut"><img src="https://url.kr/p7w879" alt="ê°€ì§€ì¹˜ê¸°" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="repot" name="do" value="repot" class="radio-button">
                                    <label for="repot"><img src="https://url.kr/iywgjg" alt="ë¶„ê°ˆì´" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="debug" name="do" value="debug" class="radio-button">
                                    <label for="debug"><img src="https://url.kr/5wi911" alt="í•´ì¶©ê´€ë¦¬" class="sticker"></label>
                                </div>
                            </div>
                            <div id="change" class="custom-radio">ì‹ë¬¼ë³€í™”<br>
                                <div class="radio-container">
                                    <input type="radio" id="balah" name="change" value="balah" class="radio-button">
                                    <label for="balah"><img src="https://url.kr/pvzbge" alt="ë°œì•„" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="ssak" name="change" value="ssak" class="radio-button">
                                    <label for="ssak"><img src="https://url.kr/h74t55" alt="ì‹¹" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="ddukip" name="change" value="ddukip" class="radio-button">
                                    <label for="ddukip"><img src="https://url.kr/mrtje5" alt="ë–¡ì" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="leaf" name="change" value="leaf" class="radio-button">
                                    <label for="leaf"><img src="https://url.kr/itnj8f" alt="í’€" class="sticker"></label>
                                </div>
                                <div class="radio-container">
                                    <input type="radio" id="flower" name="change" value="flower" class="radio-button">
                                    <label for="flower"><img src="https://url.kr/6m93r9" alt="ê½ƒ" class="sticker"></label>
                                </div>
                            </div>
                        </div>
                        <div id="upload">
                            <input type="file" name="image" accept="image/*" onchange="loadFile(this)">
                            <div class="addImage" id="image-show"></div>
                        </div>
                        <div id="commitButton">
                            <input type="reset" value="ì·¨ì†Œ" id="cancel">
                            <input type="submit" value="ë“±ë¡" id="reg">
                        </div>
                    </div>
                </div>
            </div>


            <!-- ì¼ì •ì´ ìˆëŠ” ë‚ ì§œ ëª¨ë‹¬ -->
            <div id="eventModal" class="modal">
                <div class="modal-content">
                    <span class="close event-close">&times;</span>
                    <p id="event-modal-text"></p>
                    <input type="hidden" name="modalText" id="eventModalText">
                    <p><input type="text" placeholder="ì œëª©" name="title" id="eventTitle" size="100%" readonly></p>
                    <textarea name="content" id="eventContent" placeholder="ë‚´ìš©" readonly style="resize: none;" ></textarea>
                    <div id="pictureArea"></div> <!-- ì´ë¯¸ì§€ì¹¸ -->
                    <div id="eventModalBottom">
                    </div>
                </div>
            </div>
            <!-- ëª¨ë‹¬ ë -->
        </section>
    </div>
</form>

<script>
  document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');
      var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          events: async function(info, successCallback, failureCallback){
              const eventResult = await axios({
                  method: "GET",
                  url: "/diaryJson"
              });
  
              console.log("ì¡°íšŒëœ ë‹¤ì´ì–´ë¦¬ ë°ì´í„°:", eventResult.data);
  
              const eventData = eventResult.data.diarys;
              const eventArray = [];
  
              eventData.forEach((res) => {
                  eventArray.push({
                      title: res.DIARY_TITLE,
                      start: res.DIARY_DATE,
                      description: res.DIARY_CONTENT,
                      imageUrl: res.DIARY_IMG // ì´ë¯¸ì§€ URL ì¶”ê°€
                  });
              });
  
              successCallback(eventArray);
          },
          dateClick: function(info) {
              var modal = document.getElementById("myModal");
              var span = document.getElementsByClassName("close")[0];
  
              modal.style.display = "block";
              document.getElementById("modalText").value = info.dateStr;
              document.getElementById("modal-text").innerText = info.dateStr;
              document.getElementById("title").value = ""; // Reset title
              document.getElementById("content").value = ""; // Reset content
  
              span.onclick = function() {
                  modal.style.display = "none";
              }
  
              window.onclick = function(event) {
                  if (event.target == modal) {
                      modal.style.display = "none";
                  }
              }
          },
          eventClick: function(info) {
              var modal = document.getElementById("eventModal");
              var span = document.getElementsByClassName("event-close")[0];
  
              modal.style.display = "block";
              document.getElementById("eventModalText").value = info.event.startStr;
              <!-- document.getElementById("event-modal-text").innerText = info.event.startStr; -->
              document.getElementById("eventTitle").value = info.event.title;
              document.getElementById("eventContent").value = info.event.extendedProps.description;
  
              // ì´ë¯¸ì§€ ê²½ë¡œë¥¼ ì¶”ê°€
              var pictureArea = document.getElementById("pictureArea");
              pictureArea.innerHTML = ""; // ê¸°ì¡´ ì´ë¯¸ì§€ë¥¼ ì´ˆê¸°í™”
  
              if (info.event.extendedProps.imageUrl) {
                  var img = document.createElement("img");
                  img.src = info.event.extendedProps.imageUrl;
                  img.alt = "Event Image";
                  img.style.width = "100%";
                  pictureArea.appendChild(img);
              }
  
              span.onclick = function() {
                  modal.style.display = "none";
              }
  
              window.onclick = function(event) {
                  if (event.target == modal) {
                      modal.style.display = "none";
                  }
              }
          },
          displayEventTime: false // ì´ë²¤íŠ¸ ì‹œê°„ í‘œì‹œ ë¹„í™œì„±í™”
      });
  
      calendar.render();
  });
  </script>
  
  

<script src="../assets/js/diary.js"></script>
</body>
</html>
